<!-- app/templates/admin/interface.html -->
{% extends "base.html" %} {% from "utils/macros.html" import render_form %} {%
block title %}Interface{% endblock %} {% block content %}

<h1>Upload CV</h1>
{{ render_form(form, 'admin_routes.upload_cv', 'Upload') }}

<div class="container mt-4">
  <!-- Tabs Navigation -->
  <ul class="nav nav-tabs" id="interfaceTabs" role="tablist">
    <li class="nav-item" role="presentation">
      <a
        class="nav-link active"
        id="add-project-tab"
        data-bs-toggle="tab"
        href="#add-project"
        role="tab"
        >Add Project</a
      >
    </li>
    <li class="nav-item" role="presentation">
      <a
        class="nav-link"
        id="add-skill-tab"
        data-bs-toggle="tab"
        href="#add-skill"
        role="tab"
        >Add Skill</a
      >
    </li>
    <li class="nav-item" role="presentation">
      <a
        class="nav-link"
        id="add-blog-tab"
        data-bs-toggle="tab"
        href="#add-blog"
        role="tab"
        >Add Blog</a
      >
    </li>
    <li class="nav-item" role="presentation">
      <a
        class="nav-link"
        id="add-tutorial-tab"
        data-bs-toggle="tab"
        href="#add-tutorial"
        role="tab"
        >Add Tutorial</a
      >
    </li>
    <li class="nav-item" role="presentation">
      <a
        class="nav-link"
        id="update-project-tab"
        data-bs-toggle="tab"
        href="#update-project"
        role="tab"
        >Update Project</a
      >
    </li>
    <li class="nav-item" role="presentation">
      <a
        class="nav-link"
        id="update-blog-tab"
        data-bs-toggle="tab"
        href="#update-blog"
        role="tab"
        >Update Blog</a
      >
    </li>
    <li class="nav-item" role="presentation">
      <a
        class="nav-link"
        id="update-skill-tab"
        data-bs-toggle="tab"
        href="#update-skill"
        role="tab"
        >Update Skill</a
      >
    </li>

    <li class="nav-item" role="presentation">
      <a
        class="nav-link"
        id="update-tutorial-tab"
        data-bs-toggle="tab"
        href="#update-tutorial"
        role="tab"
        >Update Tutorial</a
      >
    </li>
    <li class="nav-item" role="presentation">
      <a
        class="nav-link"
        id="delete-project-tab"
        data-bs-toggle="tab"
        href="#delete-project"
        role="tab"
        >Delete Project</a
      >
    </li>
    <li class="nav-item" role="presentation">
      <a
        class="nav-link"
        id="delete-skill-tab"
        data-bs-toggle="tab"
        href="#delete-skill"
        role="tab"
        >Delete Skill</a
      >
    </li>
    <li class="nav-item" role="presentation">
      <a
        class="nav-link"
        id="delete-blog-tab"
        data-bs-toggle="tab"
        href="#delete-blog"
        role="tab"
        >Delete Blog</a
      >
    </li>
    <li class="nav-item" role="presentation">
      <a
        class="nav-link"
        id="delete-tutorial-tab"
        data-bs-toggle="tab"
        href="#delete-tutorial"
        role="tab"
        >Delete Tutorial</a
      >
    </li>
  </ul>

  <!-- Tab Content -->
  <div class="tab-content mt-3" id="interfaceTabsContent">
    <div class="tab-pane fade show active" id="add-project" role="tabpanel">
      {{ render_form(addprojectform, 'project_routes.add_project', 'Add') }}
    </div>
    <div class="tab-pane fade" id="add-skill" role="tabpanel">
      {{ render_form(addskillform, 'skill_routes.add_skill', 'Add') }}
    </div>
    <div class="tab-pane fade" id="add-blog" role="tabpanel">
      {{ render_form(addblogform, 'blog_routes.add_blog', 'Add') }}
    </div>
    <div class="tab-pane fade" id="add-tutorial" role="tabpanel">
      {{ render_form(addtutorialform, 'tutorial_routes.add_tutorial', 'Add') }}
    </div>
    <div class="tab-pane fade" id="update-project" role="tabpanel">
      {{ render_form(updateprojectform, 'project_routes.update_project', 'Update
      Project', kwargs={'project_id': project.id}) }}
    </div>
    <div class="tab-pane fade" id="update-blog" role="tabpanel">
      {{ render_form(updateblogform, 'blog_routes.update_blog', 'Update') }}
    </div>
    <div class="tab-pane fade" id="update-skill" role="tabpanel">
      {{ render_form(updateskillform, 'skill_routes.update_skill', 'Update') }}
    </div>
    <div class="tab-pane fade" id="update-tutorial" role="tabpanel">
      {{ render_form(updatetutorialform, 'tutorial_routes.update_tutorial',
      'Update') }}
    </div>
    <div class="tab-pane fade" id="delete-project" role="tabpanel">
      {{ render_form(deleteprojectform, 'project_routes.delete_project',
      'Delete') }}
    </div>
    <div class="tab-pane fade" id="delete-skill" role="tabpanel">
      {{ render_form(deleteskillform, 'skill_routes.delete_skill', 'Delete') }}
    </div>
    <div class="tab-pane fade" id="delete-blog" role="tabpanel">
      {{ render_form(deleteblogform, 'blog_routes.delete_blog', 'Delete') }}
    </div>
    <div class="tab-pane fade" id="delete-tutorial" role="tabpanel">
      {{ render_form(deletetutorialform, 'tutorial_routes.delete_tutorial',
      'Delete') }}
    </div>
  </div>
</div>
{% endblock %} {% block js %} {{ super() }}
<script>
  $(document).ready(function () {
    // Display the current value for each range input
    $('input[type="range"]').each(function () {
      var displayElement = $('<span id="' + $(this).attr("id") + '_display"/>');
      $(this).after(displayElement);
      displayElement.text($(this).val());

      $(this).on("input change", function () {
        displayElement.text($(this).val());
      });
    });

    // Event listener for change on the project select field
    $("#project").change(function () {
      var projectId = $(this).val();
      if (projectId) {
        // AJAX call to get the project details
        $.ajax({
          url: "{{ url_for('project_routes.project_details', project_id='placeholder') }}".replace(
            "placeholder",
            projectId
          ),
          type: "GET",
          dataType: "json",
          success: function (data) {
            // Update form fields with the data returned
            $("#name").val(data.name);
            $("#description").val(data.description);
            $("#role").val(data.role);
            $("#repo_link").val(data.repo_link);
            $("#live_link").val(data.live_link);
            $("#misc_link").val(data.misc_link);
            $("#misc_name").val(data.misc_name);
            $("#status").val(data.status);
            $("#category").val(data.category_id);

            // Update checkboxes for related skills
            $('input[name="related_skills"]').each(function () {
              if (data.related_skills.includes(parseInt($(this).val()))) {
                $(this).prop("checked", true);
              } else {
                $(this).prop("checked", false);
              }
            });
          },
          error: function (error) {
            // Handle any errors
            console.log(error);
          },
        });
      }
    });
  });
</script>
{% endblock %}
